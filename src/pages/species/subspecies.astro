---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
---

<BaseLayout title="園芸品種一覧 - Platycerium Collection">
  <style>
    .fade-in {
      animation: fadeIn 0.5s ease-in;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .subspecies-card {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
    }

    .subspecies-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
    }

    .subspecies-thumbnail {
      aspect-ratio: 4 / 3;
      object-fit: cover;
      width: 100%;
      height: 220px;
    }

    .breadcrumb {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .breadcrumb-separator {
      color: #999;
    }
  </style>

  <Header />

  <main class="container mx-auto px-4 py-8">
    <!-- Breadcrumb -->
    <nav class="breadcrumb mb-6 text-sm text-gray-600">
      <a href="/" class="hover:text-forest-mid transition-colors">ホーム</a>
      <span class="breadcrumb-separator">/</span>
      <a href="/species/" class="hover:text-forest-mid transition-colors">ギャラリー</a>
      <span class="breadcrumb-separator">/</span>
      <span id="breadcrumb-current" class="text-forest-dark font-semibold">読み込み中...</span>
    </nav>

    <!-- Hero Section -->
    <div class="bg-white rounded-lg shadow-md p-8 mb-8">
      <div class="flex items-start justify-between mb-4">
        <div>
          <h2 id="parent-title" class="text-3xl md:text-4xl font-bold text-forest-dark mb-2">
            読み込み中...
          </h2>
          <p id="parent-subtitle" class="text-lg text-gray-500 italic mb-4">
            <!-- 英語名が入ります -->
          </p>
          <p id="parent-description" class="text-gray-600 text-lg">
            園芸品種を読み込んでいます...
          </p>
        </div>

        <a href="/species/" class="text-forest-mid hover:text-forest-dark transition-colors flex items-center gap-1">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
          </svg>
          大分類に戻る
        </a>
      </div>
    </div>

    <!-- Loading Indicator -->
    <div id="loading" class="text-center py-12">
      <div class="inline-flex items-center gap-2 text-gray-600">
        <svg class="animate-spin h-8 w-8" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        <span class="text-lg">品種データを読み込んでいます...</span>
      </div>
    </div>

    <!-- Error Message -->
    <div id="error" class="hidden text-center py-12">
      <p class="text-xl text-red-600 mb-4"></p>
      <div class="space-x-4">
        <button onclick="location.reload()" class="bg-forest-mid hover:bg-forest-dark text-white font-semibold py-2 px-6 rounded-lg transition-colors">
          再読み込み
        </button>
        <a href="/species/" class="inline-block bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 px-6 rounded-lg transition-colors">
          大分類に戻る
        </a>
      </div>
    </div>

    <!-- Subspecies Section -->
    <div id="subspecies-section" class="hidden">
      <div id="subspecies-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
        <!-- Subspecies cards will be rendered here -->
      </div>
    </div>
  </main>

  <Footer />

  <!-- JavaScript -->
  <script src="/scripts/subspecies-app.js" type="module"></script>

  <!-- Mobile Menu Toggle -->
  <script is:inline>
    document.getElementById('mobile-menu-btn')?.addEventListener('click', () => {
      document.getElementById('mobile-menu')?.classList.toggle('hidden');
    });
  </script>
</BaseLayout>
